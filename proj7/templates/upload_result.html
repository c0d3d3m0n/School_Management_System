<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Upload Result</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <script>
    function toggleFields() {
      const examType = document.getElementById('examType').value;
      const subjectFields = document.getElementById('subjectFields');
      const internalFields = document.getElementById('internalFields');

      if (examType === 'TERM-1') {
        subjectFields.style.display = 'none';
        internalFields.style.display = 'block';
      } else {
        subjectFields.style.display = 'block';
        internalFields.style.display = 'none';
      }

      // âœ… NEW: Adjust max for SA-1 vs PT-1/PT-2
      const inputs = document.querySelectorAll('#subjectFields input[type="number"]');
      inputs.forEach(input => {
        if (examType === 'SA-1') {
          input.max = 80;
          input.placeholder = "Marks for SA-1 subject (max 80)";
        } else {
          input.max = 50;
          input.placeholder = "Marks for subject (max 50)";
        }
      });
    }
  </script>
</head>

<body class="bg-light">

  <div class="container mt-5">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h2>Upload Result for {{ student.name }}</h2>
      <a href="{% url 'dashboard' %}" class="btn btn-secondary">Back to dashboard</a>
    </div>

    <form method="POST">
      {% csrf_token %}

      <!-- Exam type dropdown -->
      <div class="mb-3">
        <label for="examType" class="form-label">Select Exam Type:</label>
        <select id="examType" name="exam_type" class="form-select" onchange="toggleFields()" required>
          <option value="">-- Select Exam Type --</option>
          {% for type in exam_types %}
          <option value="{{ type }}">{{ type }}</option>
          {% endfor %}
        </select>
      </div>

      <!-- Subject marks -->
      <div id="subjectFields">
        <h5 class="mt-3">Subject-wise Marks</h5>
        {% for subject in subjects %}
        <div class="mb-3">
          <label class="form-label">{{ subject }}</label>
          <input type="number"
                 name="{{ subject }}"
                 class="form-control"
                 min="0"
                 max="50"
                 placeholder="Marks for {{ subject }}">
        </div>
        {% endfor %}
      </div>

      <!-- Internal marks -->
      <div id="internalFields" style="display: none;">
        {% for subject in subjects %}
        <div class="mb-4 p-3 border rounded bg-white">
          <h5>{{ subject }}</h5>
          <div class="mb-3">
            <label>Attendance (5 Marks) for {{ subject }}</label>
            <input type="number" name="attendance_{{ subject }}" min="0" max="5" class="form-control">
          </div>
          <div class="mb-3">
            <label>Notebook (5 Marks) for {{ subject }}</label>
            <input type="number" name="notebook_{{ subject }}" min="0" max="5" class="form-control">
          </div>
        </div>
        {% endfor %}
      </div>

      <button type="submit" class="btn btn-primary">Submit</button>
      <a href="{% url 'view_student' student.id %}" class="btn btn-secondary">Cancel</a>
    </form>
  </div>

</body>

</html>
